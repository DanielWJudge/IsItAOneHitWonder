---
/**
 * Build-time static path generation from list JSON (ADR-5).
 * One HTML per list entry at /result/[slug]. Full content in Story 2.3.
 */
import BaseLayout from '../../layouts/BaseLayout.astro';
import ResultBlock from '../../components/ResultBlock.astro';
import listData, { type OneHitWonderEntry } from '../../data/load-list';

export function getStaticPaths() {
	if (listData.length === 0) {
		throw new Error(
			'one-hit-wonders.json is empty. Run npm run fetch-data before build, or ensure the file is committed.'
		);
	}
	const slugs = listData.map((e) => e.slug);
	if (new Set(slugs).size !== slugs.length) {
		throw new Error('Duplicate slugs in one-hit-wonders.json; enforce uniqueness in fetch script.');
	}
	return listData.map((entry: OneHitWonderEntry) => ({
		params: { slug: entry.slug },
		props: { entry },
	}));
}

const { entry } = Astro.props;
const pageTitle = `${entry.artist} – One-Hit Wonder?`;
const metaDescription = `Yes – ${entry.artist} is a one-hit wonder. The one hit: ${entry.song}.`;
---

<BaseLayout title={pageTitle} description={metaDescription}>
	<main class="mx-auto max-w-2xl px-4 py-8">
		<h1 class="text-2xl font-semibold">Is It A One Hit Wonder</h1>
		<ResultBlock entry={entry} verdict="Yes" />
	</main>
</BaseLayout>
