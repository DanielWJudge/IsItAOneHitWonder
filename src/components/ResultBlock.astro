---
/**
 * ResultBlock: verdict, one hit, definition, source (ADR-4, ADR-5, ADR-6).
 * Used on Yes result pages and no-match page (verdict="No"). Stone/amber palette, 44px touch targets.
 */
import type { OneHitWonderEntry } from '../data/load-list';
import { SOURCE_URL, LICENSE_URL, ATTRIBUTION_LINK_CLASS } from '../lib/attribution';
import { buildShareableLine } from '../lib/shareable-line';
import CopyButton from './CopyButton.astro';

interface Props {
	entry?: OneHitWonderEntry;
	verdict: 'Yes' | 'No';
}

const { entry, verdict } = Astro.props;
const base = import.meta.env.BASE_URL;

const showOneHit = verdict === 'Yes' && entry?.artist && entry?.song;
const shareableLine = buildShareableLine(verdict, entry);
---

<section class="mt-6" aria-labelledby="verdict-heading">
	<h2 id="verdict-heading" class="text-xl font-medium text-stone-900">{verdict}</h2>
	{verdict === 'No' && <p class="mt-2 text-stone-600">Not on our list.</p>}
	{showOneHit && (
		<p class="mt-2 text-stone-600">
			The one hit: {entry!.song} – {entry!.artist}
		</p>
	)}
	<h3 id="definition-heading" class="sr-only">Definition</h3>
	<p class="mt-4 text-stone-600">
		We use the Wikipedia US one-hit wonder list: one top-40 hit in the US.
	</p>
	<h3 id="source-heading" class="sr-only">Source</h3>
	<p class="mt-2 text-sm text-stone-500">
		<a href={SOURCE_URL} class={ATTRIBUTION_LINK_CLASS}>Source: Wikipedia US list</a>
		{' · '}
		<a href={LICENSE_URL} class={ATTRIBUTION_LINK_CLASS}>CC BY-SA 4.0</a>
	</p>
</section>
<nav class="mt-6 flex flex-wrap items-center gap-3" aria-label="Result actions">
	<CopyButton client:load shareableLine={shareableLine} />
	<a href={base} class={ATTRIBUTION_LINK_CLASS}>Search again</a>
</nav>
