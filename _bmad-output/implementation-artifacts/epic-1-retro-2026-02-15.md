# Epic 1 Retrospective — Data pipeline and deploy

**Date:** 2026-02-15  
**Epic:** 1 — Data pipeline and deploy  
**Project:** IsItAOneHitWonder  
**Facilitator:** Bob (Scrum Master)

---

## 1. Epic summary and metrics

### Delivery metrics

| Metric | Value |
|--------|--------|
| Completed stories | 5/5 (100%) |
| Total stories | 5 |
| Epic status | Complete |

**Stories delivered:**

- 1-1: Set up initial project from starter template — done  
- 1-2: Implement fetch and parse script for Wikipedia one-hit wonder list — done  
- 1-3: Wire build-time JSON into Astro and static output — done  
- 1-4: Add CI workflow with fetch, build, and deploy to GitHub Pages — done  
- 1-5: Configure site URL and HTTPS for GitHub Pages — done  

### Quality and technical

- **Code reviews:** All stories had AI senior developer review; findings were addressed (Story 1-2: 7 issues; 1-3: 7 issues; 1-4, 1-5: config and docs fixes).
- **Technical debt:** One deferred item — large inline JSON payload in `index.html` (Story 1-3); documented for future optimization if bundle size becomes a concern.
- **Blockers:** None recorded; non-empty project root in 1-1 was handled by scaffolding to subdir then moving files.

### Business outcomes

- **Goals achieved:** Live site on GitHub Pages (HTTPS), MediaWiki API fetch/parse, build-time JSON, weekly refresh with graceful fallback (FR14–FR18).
- **Success criteria:** Data pipeline runs; deploy uses cached data on fetch failure; site URL and Enforce HTTPS configured.

---

## 2. Team participants

- **Bob (Scrum Master)** — Facilitated retrospective  
- **Alice (Product Owner)** — Epic scope and acceptance  
- **Charlie (Senior Dev)** — Implementation and review (Amelia/Barry-style execution)  
- **Dana (QA Engineer)** — Manual verification and quality notes  
- **DJ (Project Lead)** — Stakeholder and reviewer  

Agents used in implementation: dev-story workflow (Cursor), AI code review.

---

## 3. Successes and strengths

1. **Architecture alignment** — Stories followed ADR-1 (data pipeline), ADR-3 (deploy), ADR-5 (URLs/SEO), ADR-7 (error handling). Fetch script, build wiring, CI, and site config matched planning artifacts.
2. **Robust fetch and CI** — Story 1-2 added timeout, error handling, exit codes, and sanity checks after review. Story 1-4 implemented `continue-on-error: true`, concurrency, and documented first-time setup and JSON fallback.
3. **Shared foundations** — Story 1-3 introduced `BaseLayout.astro`, `src/data/load-list.ts`, and duplicate-slug guard in `getStaticPaths`, giving Epic 2 a clear data and layout pattern.
4. **Documentation** — DEPLOYMENT.md created (1-4) and extended (1-5) with Enforce HTTPS, post-deploy verification, and base-URL checks.
5. **Review discipline** — Every story had review; MEDIUM/LOW findings were tracked and resolved, improving error handling and config (e.g. favicon `BASE_URL` in 1-5).

---

## 4. Challenges and growth areas

1. **Project root and tooling** — Story 1-1: Astro create in non-empty dir required scaffold-in-subdir-then-move to preserve `.github/`, `.gitignore`, `_bmad/`. Tailwind v4 brought CSS-first config; `tailwind.config.mjs` kept for AC compliance.
2. **Wikitext parsing** — Story 1-2: MediaWiki list format required robust regex/patterns and citation stripping; multiple review follow-ups (timeout, try/catch, exit codes) improved production readiness.
3. **Asset paths on project site** — Story 1-5: Favicon and asset URLs broke on GitHub Pages project path until BaseLayout used `import.meta.env.BASE_URL`; same pattern will matter for Epic 2 assets.
4. **Cross-story consistency** — 1-4 review drove cross-story fixes (load-list validation, fetch retry/min entries, empty-list guard). Earlier shared contracts (e.g. load-list API) could reduce last-minute fixes.

---

## 5. Key insights and learnings

1. **Error handling and resilience first** — Timeout, non-JSON handling, file write try/catch, and distinct exit codes in the fetch script (1-2) set the tone; CI and deploy (1-4, 1-5) followed with continue-on-error and fallback JSON.
2. **Code review catches config and UX** — Reviews repeatedly improved robustness (1-2), layout/types/shared modules (1-3), and base path/HTTPS (1-5). Keeping review and addressing findings before “done” paid off.
3. **Base path and `site` are critical for GitHub Pages project sites** — `site` and `base` in `astro.config.mjs` plus `BASE_URL` in layouts/components must be correct from the start for project-site URLs and assets.
4. **First epic established patterns** — `getStaticPaths` from JSON, inlined list for client search, shared `load-list.ts`, and BaseLayout are the foundation Epic 2 will build on; no major rework needed.

---

## 6. Previous retrospective follow-through

This was the first epic; no previous retrospective to follow up on.

---

## 7. Next epic preview and dependencies

**Epic 2: Search and result experience**

- **Scope:** Single search control, client-side search by artist/song, result page with verdict, “The one hit,” definition/source, CC BY-SA 4.0, no-match state.
- **Dependencies on Epic 1:**  
  - `src/data/one-hit-wonders.json` and `load-list.ts` (build-time data).  
  - `result/[slug].astro` with `getStaticPaths` and placeholder body.  
  - List inlined as `window.__ONE_HIT_WONDERS__` for client-side search.  
  - `BaseLayout.astro`, `site`/`base`/`BASE_URL` for correct asset and canonical URLs.
- **Preparation:** No blocking prep; Fuse.js or MiniSearch choice per architecture (ADR-2). Consider documenting or revisiting large inline payload if bundle size becomes an issue during Epic 2.

---

## 8. Action items

| # | Action | Owner | Success criteria |
|---|--------|--------|-------------------|
| 1 | Use `import.meta.env.BASE_URL` (or equivalent) for any new asset or canonical URLs in Epic 2 | Dev | No broken links or assets on GitHub Pages project site |
| 2 | Choose and document client-side search library (Fuse.js or MiniSearch) in Epic 2 Story 2.2 or equivalent | Dev | ADR-2 satisfied; one library documented |
| 3 | If adding new shared data or layout contracts, align with existing `load-list.ts` and BaseLayout patterns | Dev | No duplicate loaders or layout drift |

---

## 9. Preparation tasks for Epic 2

- **Technical:** None blocking. Optional: spike or doc for Fuse.js vs MiniSearch if not already decided.
- **Documentation:** Epic 2 stories can reference this retro and the “asset path / BASE_URL” lesson for result and footer components.
- **Cleanup:** No critical cleanup; deferred “large inline payload” (1-3) remains optional for later.

---

## 10. Critical path

- No critical path items before starting Epic 2. Epic 1 is complete; site URL and HTTPS are configured; CI and data pipeline are in place.

---

## 11. Significant discoveries / epic update recommendations

- **No significant discoveries** that require changing the Epic 2 plan. Architecture and epics remain valid.  
- **Recommendation:** When implementing search and result UI (Epic 2), apply BASE_URL and asset-path learnings from Story 1-5 so result pages and footer work correctly on the project site.

---

## 12. Readiness assessment

| Area | Status |
|------|--------|
| Testing & quality | Manual verification and code review completed for all stories; no automated tests for pipeline/config. |
| Deployment | CI deploys to GitHub Pages; `site`/`base` and Enforce HTTPS documented and configured. |
| Stakeholder acceptance | Epic 1 scope (data pipeline and deploy) delivered as planned. |
| Technical health | Codebase stable; shared modules and layout in place for Epic 2. |
| Unresolved blockers | None. |

**Verdict:** Epic 1 is complete and ready for Epic 2. No blocking critical path items.

---

## 13. Commitments and next steps

- **Action items:** 3 (asset paths, search library choice, pattern alignment).  
- **Preparation tasks:** Optional spike/doc for search library.  
- **Critical path:** None.  

**Next steps:**

1. Begin Epic 2 when ready (e.g. create stories via SM agent `create-story`).  
2. Review action items in next standup or story kickoff.  
3. Revisit deferred “large inline payload” only if bundle size or performance becomes an issue during Epic 2.

---

*Retrospective complete. Epic 1–retrospective marked done in sprint-status.yaml.*
